import{_ as E}from"./preload-helper.101896b7.js";import{u as de}from"./vue-i18n.cjs.f888bd5c.js";import{L as k}from"./storage.b628b270.js";import{h as A,aH as ie,r as I,ap as B,K as j,o as ue,a9 as n,ac as ce,j as w,k as V,l as $,D as a,x as t,u as m,F as fe,Z as _e,B as i,C as d,y as ge,v as N}from"./vue.543fafcc.js";import{a as be}from"./index.92f8b057.js";import{b as ye}from"./formatTime.057ac5b9.js";import{c as we}from"./data.db8b6d88.js";import{J as ve}from"./index.4ac74e37.js";import{ay as De}from"./index.070d5527.js";import{_ as xe}from"./_plugin-vue_export-helper.c27b6911.js";import"./_commonjsHelpers.35101cd5.js";import"./request.b1530b7c.js";import"./index.7038595c.js";import"./header.9390c1c5.js";import"./index.05309dac.js";import"./index.18e5bded.js";import"./themeConfig.084d7f79.js";import"./index.3b68140d.js";const he={class:"system-role-container layout-padding"},Te={class:"system-role-padding layout-padding-auto layout-padding-view"},Ie={class:"system-user-search mb15"},je=A({name:"systemRole"}),Ce=A({...je,setup(Re){const M=ie(),{t:s}=de(),v=be(),D=I(),L=B(()=>E(()=>import("./dialog.c5d45b0e.js"),["assets/dialog.c5d45b0e.js","assets/preload-helper.101896b7.js","assets/vue.543fafcc.js","assets/vue-i18n.cjs.f888bd5c.js","assets/_commonjsHelpers.35101cd5.js","assets/data.db8b6d88.js","assets/index.7038595c.js","assets/request.b1530b7c.js","assets/storage.b628b270.js","assets/index.4ac74e37.js","assets/index.070d5527.js","assets/index.3b68140d.js","assets/header.9390c1c5.js","assets/index.05309dac.js","assets/index.18e5bded.js","assets/themeConfig.084d7f79.js","assets/index.92f8b057.js","assets/_plugin-vue_export-helper.c27b6911.js","assets/dialog.d52abfb7.css"])),P=B(()=>E(()=>import("./drawer.a423620c.js"),["assets/drawer.a423620c.js","assets/preload-helper.101896b7.js","assets/vue.543fafcc.js","assets/vue-i18n.cjs.f888bd5c.js","assets/_commonjsHelpers.35101cd5.js","assets/index.3a59200e.js","assets/request.b1530b7c.js","assets/storage.b628b270.js","assets/index.4ac74e37.js","assets/index.070d5527.js","assets/index.3b68140d.js","assets/header.9390c1c5.js","assets/index.92f8b057.js","assets/formatTime.057ac5b9.js","assets/data.db8b6d88.js","assets/index.7038595c.js","assets/index.05309dac.js","assets/index.18e5bded.js","assets/themeConfig.084d7f79.js"])),C=I(),b=I(),R=j({list:[]}),p=j({form:{appId:"",namespaceId:k.get("nid"),name:""},rules:{}}),r=j({tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:20}}}),u=async()=>{r.tableData.loading=!0;let o=await v.getList({namespaceId:k.get("nid"),appId:p.form.appId,name:p.form.name,page:r.tableData.param.pageNum,size:r.tableData.param.pageSize});r.tableData.data=[],o.list.forEach(function(e){r.tableData.data.push({id:e.id,namespaceId:e.namespaceId,appId:e.appId,appName:e.appName,workflowId:e.workflowId,name:e.name,description:e.description,processorType:e.processorType,processorInfo:e.processorInfo,executeType:e.executeType,paramsType:e.paramsType,params:e.params,extendParamsType:e.extendParamsType,extendParams:e.extendParams,timeExpressionType:e.timeExpressionType,timeExpression:e.timeExpression,timeExpressionValue:e.timeExpressionValue,executeStrategy:e.executeStrategy,failRetryTimes:e.failRetryTimes,failRetryInterval:e.failRetryInterval,concurrency:e.concurrency,status:e.status===1,createTime:ye(e.createTime)})}),r.tableData.total=o.total,setTimeout(()=>{r.tableData.loading=!1},500)},J=async(o,e)=>{const x=o?1:2;await v.updateStatus({id:e.id,status:x})},z=o=>{!o||o.validate(e=>{if(e)u();else return!1})},U=()=>{p.form.name="",p.form.appId="",u()},O=(o,e)=>{if(o==="execute"){C.value.openDialog(e);return}if(o==="copy"){b.value.openDrawer("copy",p.form.appId,e);return}if(o==="delete"){K(e);return}},F=o=>{b.value.openDrawer(o,p.form.appId)},H=(o,e)=>{b.value.openDrawer(o,p.form.appId,e)},q=o=>{M.push({path:"/admin/job-instance/list",query:{id:o.id,appId:o.appId}})},K=o=>{ve.confirm(s("message.job.job.deleteTitle")+`(${o.name})?`,s("message.commonMsg.tip"),{confirmButtonText:s("message.commonBtn.confirm"),cancelButtonText:s("message.commonBtn.cancel"),type:"warning"}).then(async()=>{await v.delete({id:o.id}),await u(),De.success(s("message.commonMsg.deleteSuccess"))}).catch(()=>{})},Z=o=>{r.tableData.param.pageSize=o,u()},G=o=>{r.tableData.param.pageNum=o,u()};return ue(async()=>{R.list=await we(),await u()}),(o,e)=>{const x=n("el-option"),Q=n("el-select"),S=n("el-form-item"),h=n("el-col"),W=n("el-input"),X=n("ele-Search"),_=n("el-icon"),g=n("el-button"),Y=n("ele-RefreshRight"),ee=n("ele-FolderAdd"),y=n("el-row"),ae=n("el-form"),c=n("el-table-column"),oe=n("el-switch"),te=n("ele-Edit"),le=n("ele-Monitor"),T=n("el-dropdown-item"),ne=n("el-dropdown-menu"),se=n("el-dropdown"),re=n("el-table"),pe=n("el-pagination"),me=ce("loading");return w(),V("div",he,[$("div",Te,[$("div",Ie,[a(ae,{ref_key:"tableSearchRef",ref:D,model:p.form,rules:p.rules},{default:t(()=>[a(y,null,{default:t(()=>[a(h,{xs:8,sm:12,md:8,lg:6,xl:4,class:"mb20"},{default:t(()=>[a(S,{label:m(s)("message.app.name"),prop:"appName"},{default:t(()=>[a(Q,{modelValue:p.form.appId,"onUpdate:modelValue":e[1]||(e[1]=l=>p.form.appId=l),filterable:"",placeholder:m(s)("message.commonMsg.all"),size:"default",style:{width:"90%"}},{default:t(()=>[(w(!0),V(fe,null,_e(R.list,l=>(w(),N(x,{key:l.id,label:l.label,value:l.id,onClick:e[0]||(e[0]=f=>z(D.value))},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(h,{xs:8,sm:12,md:8,lg:6,xl:4,class:"mb20"},{default:t(()=>[a(S,{label:m(s)("message.job.job.name"),prop:"name"},{default:t(()=>[a(W,{modelValue:p.form.name,"onUpdate:modelValue":e[2]||(e[2]=l=>p.form.name=l),size:"default",style:{width:"95%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),a(h,{xs:8,sm:12,md:8,lg:6,xl:4,class:"mb20"},{default:t(()=>[a(g,{size:"default",type:"primary",class:"ml10",onClick:e[3]||(e[3]=l=>z(D.value))},{default:t(()=>[a(_,null,{default:t(()=>[a(X)]),_:1}),i(" "+d(o.$t("message.commonBtn.query")),1)]),_:1}),a(g,{size:"default",type:"primary",class:"ml10",onClick:e[4]||(e[4]=l=>U())},{default:t(()=>[a(_,null,{default:t(()=>[a(Y)]),_:1}),i(" "+d(o.$t("message.commonBtn.reset")),1)]),_:1}),a(g,{size:"default",type:"success",class:"ml10",onClick:e[5]||(e[5]=l=>F("add"))},{default:t(()=>[a(_,null,{default:t(()=>[a(ee)]),_:1}),i(" "+d(o.$t("message.commonBtn.add")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),ge((w(),N(re,{data:r.tableData.data,style:{width:"100%"}},{default:t(()=>[a(c,{prop:"appName",label:m(s)("message.job.job.application"),"show-overflow-tooltip":""},null,8,["label"]),a(c,{prop:"name",label:m(s)("message.job.job.name"),"show-overflow-tooltip":""},null,8,["label"]),a(c,{prop:"processorInfo",label:m(s)("message.job.job.processorInfo"),"show-overflow-tooltip":""},null,8,["label"]),a(c,{prop:"executeType",label:m(s)("message.job.job.processorAndExecuteType"),"show-overflow-tooltip":""},{default:t(l=>[a(y,null,{default:t(()=>[i("["+d(l.row.processorType)+"] "+d(l.row.executeType),1)]),_:2},1024)]),_:1},8,["label"]),a(c,{prop:"timeExpression",label:m(s)("message.job.job.expressionAndType"),"show-overflow-tooltip":""},{default:t(l=>[a(y,{style:{"font-weight":"bold"}},{default:t(()=>[i(d(l.row.timeExpressionType),1)]),_:2},1024),a(y,null,{default:t(()=>[i(d(l.row.timeExpression),1)]),_:2},1024)]),_:1},8,["label"]),a(c,{prop:"status",label:m(s)("message.job.job.status"),"show-overflow-tooltip":""},{default:t(l=>[a(oe,{modelValue:l.row.status,"onUpdate:modelValue":f=>l.row.status=f,class:"ml-2",size:"default",onChange:f=>J(f,l.row),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"]),a(c,{prop:"createTime",label:m(s)("message.job.job.createTime"),"show-overflow-tooltip":""},null,8,["label"]),a(c,{label:m(s)("message.commonMsg.operation"),width:"360"},{default:t(l=>[a(g,{type:"primary",size:"default",onClick:f=>H("update",l.row)},{default:t(()=>[a(_,null,{default:t(()=>[a(te)]),_:1}),i(" "+d(o.$t("message.commonBtn.update")),1)]),_:2},1032,["onClick"]),a(g,{type:"success",size:"default",onClick:f=>q(l.row)},{default:t(()=>[a(_,null,{default:t(()=>[a(le)]),_:1}),i(" "+d(o.$t("message.commonBtn.instance")),1)]),_:2},1032,["onClick"]),a(se,{"split-button":"",type:"info",size:"default",style:{"margin-left":"12px"},onCommand:f=>O(f,l.row)},{dropdown:t(()=>[a(ne,null,{default:t(()=>[a(T,{command:"execute"},{default:t(()=>[i(d(o.$t("message.job.job.executeOnce")),1)]),_:1}),a(T,{command:"copy"},{default:t(()=>[i(d(o.$t("message.commonBtn.copy")),1)]),_:1}),a(T,{command:"delete"},{default:t(()=>[i(d(o.$t("message.commonBtn.delete")),1)]),_:1})]),_:1})]),default:t(()=>[i(d(o.$t("message.commonBtn.more"))+" ",1)]),_:2},1032,["onCommand"])]),_:1},8,["label"])]),_:1},8,["data"])),[[me,r.tableData.loading]]),a(pe,{onSizeChange:Z,onCurrentChange:G,class:"mt15","pager-count":5,"page-sizes":[10,20,30],"current-page":r.tableData.param.pageNum,"onUpdate:current-page":e[6]||(e[6]=l=>r.tableData.param.pageNum=l),background:"","page-size":r.tableData.param.pageSize,"onUpdate:page-size":e[7]||(e[7]=l=>r.tableData.param.pageSize=l),layout:"total, sizes, prev, pager, next, jumper",total:r.tableData.total},null,8,["current-page","page-size","total"])]),a(m(L),{ref_key:"nsDialogRef",ref:C,onRefresh:e[8]||(e[8]=l=>u())},null,512),a(m(P),{ref_key:"JobDrawerRef",ref:b,onRefresh:e[9]||(e[9]=l=>u())},null,512)])}}});const Ke=xe(Ce,[["__scopeId","data-v-60eea7d6"]]);export{Ke as default};
