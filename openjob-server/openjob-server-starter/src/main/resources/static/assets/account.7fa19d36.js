import{h as P,ar as U,aq as q,aH as B,K as R,a as $,a9 as n,ac as A,j as _,v as f,x as o,D as s,l as v,n as D,y as x,B as E,C as L}from"./vue.543fafcc.js";import{u as j}from"./vue-i18n.cjs.f888bd5c.js";import{u as z}from"./themeConfig.ab165958.js";import{i as J,b as K}from"./index.f4471638.js";import{S as O}from"./storage.b628b270.js";import{a as G}from"./formatTime.057ac5b9.js";import{N as H}from"./loading.7efee3a8.js";import{u as M}from"./index.4fcb57a0.js";import{u as Q}from"./userInfo.2fef1b52.js";import{ay as I}from"./index.070d5527.js";import{_ as W}from"./_plugin-vue_export-helper.c27b6911.js";import"./_commonjsHelpers.35101cd5.js";import"./index.18e5bded.js";import"./keepAliveNames.cf66da55.js";import"./routesList.76e57b72.js";import"./preload-helper.101896b7.js";import"./tagsViewRoutes.92636029.js";import"./request.c84c4c3e.js";import"./index.a654b9cd.js";import"./index.4ac74e37.js";import"./index.3b68140d.js";const X=P({name:"loginAccount"}),Y=P({...X,setup(Z){const C=M(),{t:S}=j(),V=z(),{themeConfig:N}=U(V),m=q(),g=B(),t=R({isShowPassword:!1,ruleForm:{username:"",password:"",keeplive:!0,code:"1234"},loading:{signIn:!1}}),T=$(()=>G(new Date)),k=async()=>{t.loading.signIn=!0;let a=t.ruleForm;try{const e=await C.login(a);console.log(e),Q().saveToSession(e.username,e.sessionKey,{userName:e.username,photo:"https://img2.baidu.com/it/u=1978192862,2048448374&fm=253&fmt=auto&app=138&f=JPEG?w=504&h=500",time:1800,roles:[],isAdmin:e.supperAdmin,authBtnList:[],perms:e.permNames})}catch(e){console.log(e),t.loading.signIn=!1;return}if(console.log("登录后 - 加载菜单路由列表"),N.value.isRequestRoutes){const e=await K();console.log("加载菜单路由列表",e),w(e)}else{const e=await J();w(e)}},w=a=>{var e,u,l,r;if(a)I.warning("抱歉，您没有登录权限"),O.clear();else{let i=T.value;(e=m.query)!=null&&e.redirect?g.push({path:(u=m.query)==null?void 0:u.redirect,query:Object.keys((l=m.query)==null?void 0:l.params).length>0?JSON.parse((r=m.query)==null?void 0:r.params):""}):g.push("/");const p=S("message.signInText");I.success(`${i}，${p}`),H.start()}t.loading.signIn=!1};return(a,e)=>{const u=n("ele-User"),l=n("el-icon"),r=n("el-input"),i=n("el-form-item"),p=n("ele-Unlock"),F=n("ele-Position"),d=n("el-col"),h=n("el-button"),b=n("el-form"),y=A("waves");return _(),f(b,{size:"large",class:"login-content-form"},{default:o(()=>[s(i,{class:"login-animation1"},{default:o(()=>[s(r,{text:"",placeholder:a.$t("message.account.accountPlaceholder1"),modelValue:t.ruleForm.username,"onUpdate:modelValue":e[0]||(e[0]=c=>t.ruleForm.username=c),clearable:"",autocomplete:"off"},{prefix:o(()=>[s(l,{class:"el-input__icon"},{default:o(()=>[s(u)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),s(i,{class:"login-animation2"},{default:o(()=>[s(r,{type:t.isShowPassword?"text":"password",placeholder:a.$t("message.account.accountPlaceholder2"),modelValue:t.ruleForm.password,"onUpdate:modelValue":e[2]||(e[2]=c=>t.ruleForm.password=c),autocomplete:"off"},{prefix:o(()=>[s(l,{class:"el-input__icon"},{default:o(()=>[s(p)]),_:1})]),suffix:o(()=>[v("i",{class:D(["iconfont el-input__icon login-content-password",t.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:e[1]||(e[1]=c=>t.isShowPassword=!t.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),s(i,{class:"login-animation3"},{default:o(()=>[s(d,{span:15},{default:o(()=>[s(r,{text:"",maxlength:"4",placeholder:a.$t("message.account.accountPlaceholder3"),modelValue:t.ruleForm.code,"onUpdate:modelValue":e[3]||(e[3]=c=>t.ruleForm.code=c),clearable:"",autocomplete:"off"},{prefix:o(()=>[s(l,{class:"el-input__icon"},{default:o(()=>[s(F)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),s(d,{span:1}),s(d,{span:8},{default:o(()=>[x((_(),f(h,{class:"login-content-code"},{default:o(()=>[E("1234")]),_:1})),[[y]])]),_:1})]),_:1}),s(i,{class:"login-animation4"},{default:o(()=>[x((_(),f(h,{type:"primary",class:"login-content-submit",round:"",onClick:k,loading:t.loading.signIn},{default:o(()=>[v("span",null,L(a.$t("message.account.accountBtnText")),1)]),_:1},8,["loading"])),[[y]])]),_:1})]),_:1})}}});const xe=W(Y,[["__scopeId","data-v-0cd136ae"]]);export{xe as default};
