import{h as P,ar as R,aq as U,aH as q,K as $,a as A,a9 as i,ac as D,j as _,v as g,x as t,D as s,l as x,n as M,y as C,B as E,C as V}from"./vue.bd0669ce.js";import{u as J}from"./vue-i18n.cjs.2a00fe88.js";import{u as L}from"./themeConfig.cb88f033.js";import{i as j,b as z}from"./index.b811dcf9.js";import{S as K}from"./storage.b628b270.js";import{a as O}from"./formatTime.057ac5b9.js";import{N as G}from"./loading.3e617409.js";import{u as H}from"./index.c41e61d7.js";import{u as Q}from"./userInfo.f7c9dd73.js";import{J as W}from"./index.f64fca3a.js";import{ay as I}from"./index.e8f4f9cf.js";import{_ as X}from"./_plugin-vue_export-helper.c27b6911.js";import"./_commonjsHelpers.35101cd5.js";import"./index.aa7cec2e.js";import"./keepAliveNames.f05bad75.js";import"./routesList.32d6bb58.js";import"./preload-helper.101896b7.js";import"./tagsViewRoutes.054c4a6f.js";import"./request.386cf962.js";import"./index.c3b4fd97.js";import"./index.ee56f1f7.js";const Y=P({name:"loginAccount"}),Z=P({...Y,setup(ee){const S=H(),{t:d}=J(),F=L(),{themeConfig:N}=R(F),p=U(),w=q(),o=$({isShowPassword:!1,randomCode:((n=4)=>{let e="0123456789";function c(l,u){return Math.round(Math.random()*(u-l)+l)}let a="";for(var r=0;r<n;r++)a+=e[c(0,e.length-1)];return a})(),ruleForm:{username:"",password:"",keeplive:!0,code:""},loading:{signIn:!1}}),T=A(()=>O(new Date)),k=async()=>{if(o.randomCode!=o.ruleForm.code){await W.alert(d("message.codeMsg.c105"),d("message.commonMsg.tip"),{type:"warning"});return}o.loading.signIn=!0;let n=o.ruleForm;try{const e=await S.login(n);console.log(e),Q().saveToSession(e.username,e.sessionKey,{userName:e.username,photo:"https://img2.baidu.com/it/u=1978192862,2048448374&fm=253&fmt=auto&app=138&f=JPEG?w=504&h=500",time:1800,roles:[],isAdmin:e.supperAdmin,authBtnList:[],perms:e.permNames})}catch(e){console.log(e),o.loading.signIn=!1;return}if(console.log("登录后 - 加载菜单路由列表"),N.value.isRequestRoutes){const e=await z();console.log("加载菜单路由列表",e),h(e)}else{const e=await j();h(e)}},h=n=>{var e,c,a,r;if(n)I.warning("抱歉，您没有登录权限"),K.clear();else{let l=T.value;(e=p.query)!=null&&e.redirect?w.push({path:(c=p.query)==null?void 0:c.redirect,query:Object.keys((a=p.query)==null?void 0:a.params).length>0?JSON.parse((r=p.query)==null?void 0:r.params):""}):w.push("/");const u=d("message.signInText");I.success(`${l}，${u}`),G.start()}o.loading.signIn=!1};return(n,e)=>{const c=i("ele-User"),a=i("el-icon"),r=i("el-input"),l=i("el-form-item"),u=i("ele-Unlock"),b=i("ele-Position"),f=i("el-col"),y=i("el-button"),B=i("el-form"),v=D("waves");return _(),g(B,{size:"large",class:"login-content-form"},{default:t(()=>[s(l,{class:"login-animation1"},{default:t(()=>[s(r,{text:"",placeholder:n.$t("message.account.accountPlaceholder1"),modelValue:o.ruleForm.username,"onUpdate:modelValue":e[0]||(e[0]=m=>o.ruleForm.username=m),clearable:"",autocomplete:"off"},{prefix:t(()=>[s(a,{class:"el-input__icon"},{default:t(()=>[s(c)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),s(l,{class:"login-animation2"},{default:t(()=>[s(r,{type:o.isShowPassword?"text":"password",placeholder:n.$t("message.account.accountPlaceholder2"),modelValue:o.ruleForm.password,"onUpdate:modelValue":e[2]||(e[2]=m=>o.ruleForm.password=m),autocomplete:"off"},{prefix:t(()=>[s(a,{class:"el-input__icon"},{default:t(()=>[s(u)]),_:1})]),suffix:t(()=>[x("i",{class:M(["iconfont el-input__icon login-content-password",o.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:e[1]||(e[1]=m=>o.isShowPassword=!o.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),s(l,{class:"login-animation3"},{default:t(()=>[s(f,{span:15},{default:t(()=>[s(r,{text:"",maxlength:"4",placeholder:n.$t("message.account.accountPlaceholder3"),modelValue:o.ruleForm.code,"onUpdate:modelValue":e[3]||(e[3]=m=>o.ruleForm.code=m),clearable:"",autocomplete:"off"},{prefix:t(()=>[s(a,{class:"el-input__icon"},{default:t(()=>[s(b)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),s(f,{span:1}),s(f,{span:8},{default:t(()=>[C((_(),g(y,{class:"login-content-code"},{default:t(()=>[E(V(o.randomCode),1)]),_:1})),[[v]])]),_:1})]),_:1}),s(l,{class:"login-animation4"},{default:t(()=>[C((_(),g(y,{type:"primary",class:"login-content-submit",round:"",onClick:k,loading:o.loading.signIn},{default:t(()=>[x("span",null,V(n.$t("message.account.accountBtnText")),1)]),_:1},8,["loading"])),[[v]])]),_:1})]),_:1})}}});const Ve=X(Z,[["__scopeId","data-v-75eedce7"]]);export{Ve as default};
